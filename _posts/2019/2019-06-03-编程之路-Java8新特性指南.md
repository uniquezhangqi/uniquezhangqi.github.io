---
layout:     post             				# ä½¿ç”¨çš„å¸ƒå±€ï¼ˆä¸éœ€è¦æ”¹ï¼‰
title:      è‡ªæˆ‘æ€»ç»“Java8æ–°ç‰¹æ€§   # æ ‡é¢˜ 
subtitle:    ğŸ§					  				#å‰¯æ ‡é¢˜
date:       2019-06-03  					# æ—¶é—´
author:     Ian                  			# ä½œè€…
header-img: img/home-bg-o.jpg	#è¿™ç¯‡æ–‡ç« æ ‡é¢˜èƒŒæ™¯å›¾ç‰‡
catalog: true                        	# æ˜¯å¦å½’æ¡£
tags:                              		#æ ‡ç­¾
    - ç¼–ç¨‹ä¹‹è·¯
    - è‡ªæˆ‘æ€»ç»“
    - Java Basics
---

Z æ˜¨å¤©å’Œå¤§å®¶ä¸€èµ·å›é¡¾äº†[Java8ä¹‹å‰ç‰ˆæœ¬çš„ç‰¹æ€§](http://uniquezhangqi.top/2018/06/09/%E7%BC%96%E7%A8%8B%E4%B9%8B%E8%B7%AF-Java8%E4%B9%8B%E5%89%8D%E7%89%88%E6%9C%AC%E7%9A%84%E7%89%B9%E6%80%A7/) ä»Šå¤©æ˜¯Java 8 çš„æ–°ç‰¹æ€§ï¼Œåé¢å·¥ä½œä½¿ç”¨ä¸­é‡åˆ°é—®é¢˜çš„è¯ï¼ŒZ ä¼šå•ç‹¬å†™ï¼Œå’Œå¤§å®¶ä¸€èµ·å­¦ä¹ ã€‚ å³ä¾§æœ‰ç›®å½• ç›®å½•æœ‰æ»šåŠ¨æ¡ï¼Œæ–¹ä¾¿é˜…è¯»ã€‚

### å…è®¸åœ¨æ¥å£ä¸­æœ‰é»˜è®¤æ–¹æ³•å®ç°

Java 8 å…è®¸æˆ‘ä»¬ä½¿ç”¨ `default` å…³é”®å­—ï¼Œä¸ºæ¥å£å£°æ˜æ·»åŠ éæŠ½è±¡çš„æ–¹æ³•å®ç°ã€‚è¿™ä¸ªç‰¹æ€§åˆè¢«ç§°ä¸º`æ‰©å±•æ–¹æ³•`ã€‚ä¸‹é¢æ˜¯æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªä¾‹å­ï¼š

```java
interface Formula{
    double calculate(int a);
    
    default double sqrt(int a){
        return Math.sqrt(a);
    }
}
```
åœ¨æ¥å£`Formula`ä¸­ï¼Œé™¤äº†æŠ½è±¡æ–¹æ³•`caculate`ä»¥å¤–ï¼Œè¿˜å®šä¹‰äº†ä¸€ä¸ªé»˜è®¤æ–¹æ³•`sqrt`ã€‚`Formula`çš„å®ç°ç±»åªéœ€è¦å®ç°æŠ½è±¡æ–¹æ³•`caculate`å°±å¯ä»¥äº†ã€‚é»˜è®¤æ–¹æ³•`sqrt`å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚

```java
Formula formula = new Formula(){
    @Override
    public double caculate(int a){
		return sqrt(a * 100);
	}
};

formula.calculate(100); //100.0
formula.sqrt(16); //4.0
```
Formula å¯¹è±¡ä»¥åŒ¿åå¯¹è±¡çš„å½¢å¼å®ç°äº†`Formula`æ¥å£ã€‚ä»£ç å¾ˆå•°å—¦ï¼šç”¨äº†6è¡Œä»£ç æ‰å®ç°äº†ä¸€ä¸ªç®€å•çš„è®¡ç®—åŠŸèƒ½ï¼š`a*100`å¼€å¹³æ–¹æ ¹ã€‚ä½†æ˜¯åœ¨Java 8ä¸­è¿˜æœ‰ä¸€ç§æ›´åŠ ä¼˜ç¾çš„æ–¹æ³•ï¼Œèƒ½å¤Ÿå®ç°åŒ…å«å•ä¸ªå‡½æ•°çš„å¯¹è±¡ã€‚

### Lambdaè¡¨è¾¾å¼
æˆ‘ä»¬ä»æœ€ç®€å•çš„ä¾‹å­å¼€å§‹ï¼Œæ¥å­¦ä¹ å¦‚ä½•å¯¹ä¸€ä¸ª`String`åˆ—è¡¨è¿›è¡Œæ’åºã€‚æˆ‘ä»¬é¦–å…ˆä½¿ç”¨Java 8 ä¹‹å‰çš„æ–¹æ³•æ¥å®ç°ï¼š

```java
List<String> names = Arrays.asList("peter","anna","mike","xenia");
Collections.sort(names, new Comparator<String>(){
	@Override
	public int compare(String a, String b){
        return b.compareTo(a);
	}
});
```
é™æ€å·¥å…·æ–¹æ³•`Collection.sort`æ¥æ”¶ä¸€ä¸ªlist ï¼Œå’Œä¸€ä¸ª`Comparator`æ¥å£ä½œä¸ºè¾“å…¥å‚æ•°ï¼Œ`Comparator`çš„å®ç°ç±»å¯ä»¥å¯¹è¾“å…¥çš„`list`ä¸­çš„å…ƒç´ è¿›è¡Œæ¯”è¾ƒã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ç›´æ¥ç”¨åˆ›å»ºåŒ¿å`Comparator`å¯¹è±¡ï¼Œå¹¶æŠŠå®ƒä½œä¸ºå‚æ•°ä¼ é€’ç»™`sort`æ–¹æ³•ã€‚


é™¤äº†åˆ›å»ºåŒ¿åå¯¹è±¡ä»¥å¤–ï¼ŒJava 8 è¿˜æä¾›äº†ä¸€ç§æ›´ç®€æ´çš„æ–¹å¼ï¼Œ`Lambda`è¡¨è¾¾å¼ã€‚

```java
Collections.sort(names,(String a, String b) -> b.compareTo(a));
```
åªè¦ä¸€è¡Œä»£ç ï¼ŒåŒ…å«äº†æ–¹æ³•ä½“ã€‚ä½ ç”šè‡³å¯ä»¥è¿å¤§æ‹¬å·å¯¹`{}`å’Œ`return` å…³é”®å­—éƒ½çœç•¥ä¸è¦ã€‚ä¸è¿‡è¿™è¿˜ä¸æ˜¯æœ€çŸ­çš„å†™æ³•ï¼š

```java
Collections.sort(names,(a,b) -> b.compareTo(a));
```
ç¼–è¯‘å™¨èƒ½å¤Ÿè‡ªåŠ¨è¯†åˆ«å‚æ•°çš„ç±»å‹ï¼Œæ‰€ä»¥ä½ å°±å¯ä»¥çœç•¥æ‰ç±»å‹ä¸å†™ã€‚

#### å‡½æ•°å¼æ¥å£
Lambda è¡¨è¾¾å¼å¦‚ä½•åŒ¹é…Javaçš„ç±»å‹ç³»ç»Ÿï¼Ÿæ¯ä¸€ä¸ª`lambda`éƒ½èƒ½å¤Ÿé€šè¿‡ä¸€ä¸ªç‰¹å®šçš„æ¥å£ï¼Œä¸ä¸€ä¸ªç»™å®šçš„ç±»å‹è¿›è¡ŒåŒ¹é…ã€‚ä¸€ä¸ªæ‰€è°“çš„å‡½æ•°å¼æ¥å£å¿…é¡»è¦æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•å£°æ˜ã€‚æ¯ä¸ªä¸ä¹‹å¯¹åº”çš„`lambda`è¡¨è¾¾å¼å¿…é¡»è¦ä¸æŠ½è±¡æ–¹æ³•çš„å£°æ˜ç›¸åŒ¹é…ã€‚ç”±äºé»˜è®¤æ–¹æ³•ä¸æ˜¯æŠ½è±¡çš„ï¼Œå› æ­¤ä½ å¯ä»¥åœ¨ä½ çš„å‡½æ•°å¼æ¥å£é‡Œä»»æ„æ·»åŠ é»˜è®¤æ–¹æ³•ã€‚

ä»»æ„åªåŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥ç”¨æ¥åšæˆlambdaè¡¨è¾¾å¼ã€‚ä¸ºäº†è®©æˆ‘ä»¬å®šä¹‰çš„æ¥å£æ»¡è¶³è¦æ±‚ï¼Œä½ åº”å½“åœ¨æ¥å£å‰åŠ ä¸Š`@FunctionalInterface`æ³¨è§£ã€‚ç¼–è¯‘å™¨ä¼šæ³¨æ„åˆ°è¿™ä¸ªæ³¨è§£ï¼Œå¦‚æœä½ çš„æ¥å£å®šä¹‰äº†ç¬¬äºŒä¸ªæŠ½è±¡æ–¹æ³•çš„è¯ï¼Œç¼–è¯‘å™¨ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚


ä¸¾ä¾‹ï¼š

```java
@FunctionalInterface
interface Converter<F,T> {
    T convert(F from);
}

Converter<String, Integer> converter = (from) -> Integer.valueOf(from);
Integer converted = converter.convert("123");
System.out.println(converted); //123
```
æ³¨æ„ï¼Œå¦‚æœä½ ä¸å†™@FunctionalInterface æ³¨è§£ï¼Œç¨‹åºä¹Ÿæ˜¯æ­£ç¡®çš„ã€‚

### æ–¹æ³•å’Œæ„é€ å‡½æ•°å¼•ç”¨
ä¸Šé¢çš„ä»£ç å®ä¾‹å¯ä»¥é€šè¿‡é™æ€æ–¹æ³•å¼•ç”¨ï¼Œä½¿ä¹‹æ›´åŠ ç®€æ´ï¼š

```java
Converter<String, Integer> converter = Integer::valueOf;
Integer converted = converter.convert("123");
System.out.println(converted); //123
```
Java 8 å…è®¸æˆ‘ä»¬é€šè¿‡ :: å…³é”®å­—è·å–æ–¹æ³•æˆ–è€…æ„é€ å‡½æ•°çš„å¼•ç”¨ã€‚ä¸Šé¢ä¾‹å­å°±æ˜¯æ¼”ç¤ºäº†å¦‚ä½•å¼•ç”¨ä¸€ä¸ªä¸€ä¸ªé™æ€æ–¹æ³•ã€‚è€Œä¸”ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å¯¹ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•è¿›è¡Œå¼•ç”¨ï¼š

```java
class Something{
    String startsWith(String s){
		return String.valueOf(s.charAt(0));
	}
}
Something something = new Something();
Converter<String, String> converter = something :: startsWith;
String converted = converter.convert("java");
System.out.println(converted);
```

è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ä½¿ç”¨:: å…³é”®å­—å¼•ç”¨æ„é€ å‡½æ•°ã€‚é¦–å…ˆæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªç¤ºä¾‹beanï¼ŒåŒ…å«äº†ä¸åŒçš„æ„é€ æ–¹æ³•ï¼š

```java
class Person{
    String firstName;
    String lastName;
    Person(){}
    Person(String firstName,String lastName){
        this.firstName = firstName;
        this.lastName = lastName;
    }
}
```
æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ª`person`å·¥å‚æ¥å£ï¼Œç”¨æ¥åˆ›å»ºæ–°çš„`person`å¯¹è±¡ï¼š

```java
interface PersonFactory<P extends Person>{
    p create(String firstName,String lastName);
}
```

ç„¶åæˆ‘ä»¬é€šè¿‡æ„é€ å‡½æ•°å¼•ç”¨æ¥æŠŠæ‰€æœ‰ä¸œè¥¿æ‹¼åˆ°ä¸€èµ·ï¼Œè€Œä¸æ˜¯åƒä»¥å‰ä¸€æ ·ï¼Œé€šè¿‡æ‰‹åŠ¨å®ç°ä¸€ä¸ªå·¥å‚æ¥è¿™ä¹ˆåšã€‚
```java
PersonFactory<Person> personFactory = Person :: new;
Person person = personFactory.create("Peter","Parker");
```

æˆ‘ä»¬é€šè¿‡`Person::new` æ¥åˆ›å»ºä¸€ä¸ª`Person` ç±»æ„é€ å‡½æ•°çš„å¼•ç”¨ã€‚Javaç¼–è¯‘å™¨ä¼šè‡ªåŠ¨åœ°é€‰æ‹©åˆé€‚çš„æ„é€ å‡½æ•°æ¥åŒ¹é…`PersonFactory.create`å‡½æ•°çš„ç­¾åï¼Œå¹¶é€‰æ‹©æ­£ç¡®çš„æ„é€ å‡½æ•°å½¢å¼ã€‚

#### Lambdaçš„èŒƒå›´
å¯¹äº`lambda`è¡¨è¾¾å¼å¤–éƒ¨çš„å˜é‡ï¼Œå…¶è®¿é—®æƒé™çš„ç²’åº¦ä¸åŒ¿åå¯¹è±¡çš„æ–¹å¼éå¸¸ç±»ä¼¼ã€‚ä½ èƒ½å¤Ÿè®¿é—®å±€éƒ¨å¯¹åº”çš„å¤–éƒ¨åŒºåŸŸçš„å±€éƒ¨`final`å˜é‡ï¼Œä»¥åŠæˆå‘˜å˜é‡å’Œé™æ€å˜é‡ã€‚

#### è®¿é—®å±€éƒ¨å˜é‡
æˆ‘ä»¬å¯ä»¥è®¿é—®`lambda`è¡¨è¾¾å¼å¤–éƒ¨`final`å±€éƒ¨å˜é‡ï¼š

```java
final int num =1;
Converter<Integer,String> stringConverter = (from) -> String.valueOf(from + num);
stringConverter.convert(2); //3
```
ä½†æ˜¯ä¸åŒ¿åå¯¹è±¡ä¸åŒçš„æ˜¯ï¼Œå˜é‡`num`å¹¶ä¸éœ€è¦ä¸€å®šæ˜¯`final`ã€‚ä¸‹é¢ä»£ç ä¾ç„¶æ˜¯åˆæ³•çš„ï¼š

```java
int num =1;
Converter<Integer,String> stringConverter = (from) -> String.valueOf(from + num);
stringConverter.convert(2); // 3
```

ç„¶è€Œï¼Œ`num`åœ¨ç¼–è¯‘çš„æ—¶å€™è¢«éšå¼åœ°å½“åš`final`å˜é‡æ¥å¤„ç†ã€‚ä¸‹é¢çš„ä»£ç å°±ä¸åˆæ³•ï¼š

```java
int num = 1;
Converter<Integer,String> stringConverter = (from) -> String.valueOf(from+num);
num = 3;
```

åœ¨`lambda`è¡¨è¾¾å¼å†…éƒ¨ä¼å›¾æ”¹å˜num çš„å€¼ä¹Ÿæ˜¯ä¸å…è®¸çš„ã€‚

#### è®¿é—®æˆå‘˜å˜é‡å’Œé™æ€å˜é‡
ä¸å±€éƒ¨å˜é‡ä¸åŒï¼Œæˆ‘ä»¬åœ¨`lambda`è¡¨è¾¾å¼çš„å†…éƒ¨èƒ½è·å–åˆ°å¯¹æˆå‘˜å˜é‡æˆ–é™æ€å˜é‡çš„è¯»å†™æƒã€‚è¿™ç§è®¿é—®è¡Œä¸ºåœ¨åŒ¿åå¯¹è±¡é‡Œæ˜¯éå¸¸å…¸å‹çš„ã€‚

```java
class Lambda{
    static int outerStaticNum;
    int outerNum;
    
    void testScopes(){
        Converter<Integer,String> stringConverter1 = (from) -> {
			outerNum = 23;
			return String.valueOf(from);
		};
		Converter<Integer,String> stringConverter1 = (from) -> {
			outerStaticNum = 72;
			return String.valueOf(from);
   		};
    }
}
```

#### è®¿é—®é»˜è®¤æ¥å£æ–¹æ³•
ä¹‹å‰çš„`formula`ä¾‹å­ï¼Œæ¥å£`Formula`å®šä¹‰äº†ä¸€ä¸ªé»˜è®¤çš„æ–¹å¼`sqrt`ï¼Œè¯¥æ–¹æ³•èƒ½å¤Ÿè®¿é—®`formula`æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹ï¼ŒåŒ…æ‹¬åŒ¿åå¯¹è±¡ã€‚è¿™ä¸ªå¯¹`lambda`è¡¨è¾¾å¼æ¥è®²åˆ™æ— æ•ˆã€‚


é»˜è®¤æ–¹æ³•æ— æ³•åœ¨`lambda`è¡¨è¾¾å¼å†…éƒ¨è¢«è®¿é—®ã€‚å› æ­¤ä¸‹é¢çš„ä»£ç æ˜¯æ— æ³•é€šè¿‡ç¼–è¯‘çš„ï¼š
```java
Formula formula = (a) -> sqrt(a * 100);
```

### å†…ç½®å‡½æ•°å¼æ¥å£
JDK 1.8 APIä¸­åŒ…å«äº†å¾ˆå¤šå†…ç½®çš„å‡½æ•°å¼æ¥å£ã€‚æœ‰äº›æ˜¯åœ¨ä»¥å‰ç‰ˆæœ¬çš„Javaä¸­å¤§å®¶è€³ç†Ÿèƒ½è¯¦çš„ï¼Œä¾‹å¦‚`Comparator`æ¥å£ï¼Œæˆ–è€…`Runnable`æ¥å£ã€‚å¯¹è¿™äº›ç°æˆçš„æ¥å£è¿›è¡Œå®ç°ï¼Œå¯ä»¥é€šè¿‡ `@FunctionalInterface` æ³¨è§£æ¥å¯ç”¨LambdaåŠŸèƒ½æ”¯æŒã€‚

æ­¤å¤–ï¼ŒJava 8 API è¿˜æä¾›äº†å¾ˆå¤šæ–°çš„å‡½æ•°å¼æ¥å£ï¼Œæ¥é™ä½ç¨‹åºå‘˜çš„å·¥ä½œè´Ÿæ‹…ã€‚æœ‰äº›æ–°çš„æ¥å£å·²ç»åœ¨[Google Guava](https://zhuanlan.zhihu.com/p/33253953)åº“ä¸­å¾ˆæœ‰åäº†ã€‚å¦‚æœä½ å¯¹è¿™äº›åº“å¾ˆç†Ÿçš„è¯ï¼Œä½ ç”šè‡³é—­ä¸Šçœ¼ç›éƒ½èƒ½å¤Ÿæƒ³åˆ°ï¼Œè¿™äº›æ¥å£åœ¨ç±»åº“çš„å®ç°è¿‡ç¨‹ä¸­èµ·äº†å¤šä¹ˆå¤§çš„ä½œç”¨ã€‚

#### Predicates
Predicate æ˜¯ä¸€ä¸ªå¸ƒå°”ç±»å‹çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°åªæœ‰ä¸€ä¸ªè¾“å…¥å‚æ•°ã€‚`Predicate`æ¥å£åŒ…å«äº†å¤šç§é»˜è®¤æ–¹æ³•ï¼Œç”¨äºå¤„ç†å¤æ‚çš„é€»è¾‘åŠ¨è¯(andï¼Œorï¼Œnegate)

```java
Predicate<String> predicate = (s) -> s.length() > 0;

/*
java.math.BigDecimal.negate() è¿”å›ä¸€ä¸ªBigDecimalï¼Œå…¶å€¼æ˜¯(-this)ï¼Œå…¶æ ‡åº¦æ˜¯this.scale()ã€‚
*/
predicate.test("foo"); //true
predicate.negate().test("foo"); //false

Predicate<Boolean> nonNull = Objects :: nonNull;
Predicate<Boolean> isNull = Objects :: isNull;

Predicate<String> isEmpty = String :: isEmpty;
Predicate<String> isNotEmpty = isEmpty.negate();

```

#### Functions
`Functions` æ¥å£æ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œå¹¶è¿”å›å•ä¸€çš„ç»“æœã€‚é»˜è®¤æ–¹æ³•å¯ä»¥å°†å¤šä¸ªå‡½æ•°ä¸²åœ¨ä¸€èµ·(compse, andThen)

```java
Function<String,Integer> toInteger = integer :: valueOf;
Function<String, String> backToString = toInteger.andThen(String::valueOf);
backToString.apply("123"); // "123"
```

#### Suppliers
`Supplier` æ¥å£äº§ç”Ÿä¸€ä¸ªç»™å®šç±»å‹çš„ç»“æœã€‚ä¸`Function`ä¸åŒçš„æ˜¯ï¼Œ`Supplier`æ²¡æœ‰è¾“å…¥å‚æ•°ã€‚

```java
Supplier<Person> personSupplier = Person :: new;
personSupplier.get(); // new Person
```

#### Consumers
`Consumers` ä»£è¡¨äº†åœ¨ä¸€ä¸ªè¾“å…¥å‚æ•°ä¸Šéœ€è¦è¿›è¡Œçš„æ“ä½œã€‚

```java
Consumer<Person> greeter = (p) -> System.out.println("Hello,"+p.firstName);
greeter.accept(new Person("Luke"ï¼Œ"Skywalker"));
```

#### Comparators
`Comparator` æ¥å£åœ¨æ—©æœŸçš„ Java ç‰ˆæœ¬ä¸­éå¸¸è‘—åã€‚Java 8 ä¸ºè¿™ä¸ªæ¥å£æ·»åŠ äº†ä¸åŒçš„é»˜è®¤æ–¹æ³•ã€‚

```java
Comparator<Person> comparator = (p1,p2) -> p1.firstName.compareTo(p2.firstName);

Person p1 = new Person("John","Doe");
Person p2 = new Person("Alice","Wonderland");

comparator.compare(p1, p2); // >0
comparator.reversed().compare(p1, p2); //<0
```

#### Optionals
`Optional`ä¸æ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼Œè€Œæ˜¯ä¸€ä¸ªç²¾å·§çš„å·¥å…·æ¥å£ï¼Œç”¨æ¥é˜²æ­¢`NullPointerEcption`äº§ç”Ÿã€‚è¿™ä¸ªæ¦‚å¿µåœ¨ä¸‹é¢ä¼šè¯´åˆ°ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨è¿™é‡Œå¿«é€Ÿåœ°æµè§ˆä¸€ä¸‹`Optional`çš„å·¥ä½œåŸç†ã€‚


`Optional` æ˜¯ä¸€ä¸ªç®€å•çš„å€¼å®¹å™¨ï¼Œè¿™ä¸ªå€¼å®¹å™¨å¯ä»¥æ˜¯`null` ï¼Œä¹Ÿå¯ä»¥æ˜¯`non-null`ã€‚è€ƒè™‘åˆ°ä¸€ä¸ªæ–¹æ³•å¯èƒ½ä¼šè¿”å›ä¸€ä¸ª`non-null`çš„å€¼ï¼Œä¹Ÿå¯èƒ½è¿”å›ä¸€ä¸ªç©ºå€¼ã€‚ä¸ºäº†ä¸ç›´æ¥è¿”å›nullï¼Œæˆ‘ä»¬åœ¨Java 8 ä¸­å°±è¿”å›ä¸€ä¸ª `Optional`ã€‚

```java
Optional<String> optional = Optional.of("bam");

optional.isPresent(); // true
optional.get(); //"bam"
optional.orElse("fallback"); //"bam"

optional.ifPresent((s) -> System.out.println(s.charAt(0)); // "b"
```

#### Streams
`java.util.Stream `è¡¨ç¤ºäº†æŸä¸€ç§å…ƒç´ çš„åºåˆ—ï¼Œåœ¨è¿™äº›å…ƒç´ ä¸Šå¯ä»¥è¿›è¡Œå„ç§æ“ä½œã€‚Streamsæ“ä½œå¯ä»¥æ˜¯ä¸­é—´æ“ä½œï¼Œä¹Ÿå¯ä»¥æ˜¯å®Œç»“æ“ä½œã€‚å®Œç»“æ“ä½œä¼šè¿”å›ä¸€ä¸ªæŸç§ç±»å‹çš„å€¼ï¼Œè€Œä¸­é—´æ“ä½œä¼šè¿”å›æµå¯¹è±¡æœ¬èº«ï¼Œå¹¶ä¸”ä½ å¯ä»¥é€šè¿‡å¤šæ¬¡è°ƒç”¨åŒä¸€ä¸ªæµæ“ä½œæ–¹æ³•æ¥å°†æ“ä½œç»“æœä¸²èµ·æ¥(å°±åƒ`StringBuffer`çš„`append`æ–¹æ³•ä¸€æ ·)ã€‚`Stream`æ˜¯åœ¨ä¸€ä¸ªæºçš„åŸºç¡€ä¸Šåˆ›å»ºå‡ºæ¥çš„ï¼Œä¾‹å¦‚`java.util.Collection`ä¸­çš„ list æˆ–è€… set (`map`ä¸èƒ½ä½œä¸º`Stream`çš„æº)ã€‚`Stream`æ“ä½œå¾€å¾€å¯ä»¥é€šè¿‡é¡ºåºæˆ–è€…å¹¶è¡Œä¸¤ç§æ–¹å¼æ¥æ‰§è¡Œã€‚


æˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹åºåˆ—æµã€‚é¦–å…ˆï¼Œæˆ‘ä»¬é€šè¿‡String ç±»å‹çš„ list çš„å½¢å¼åˆ›å»ºç¤ºä¾‹æ•°æ®ï¼š
```java
List<String> stringCollection = new ArrayList<>();
stringCollection.add("ddd2");
stringCollection.add("aaa2");
stringCollection.add("bbb1");
stringCollection.add("aaa1");
stringCollection.add("bbb3");
stringCollection.add("ccc");
stringCollection.add("bbb2");
stringCollection.add("ddd1");
```
Java 8 ä¸­çš„ `Collections`ç±»çš„åŠŸèƒ½å·²ç»æœ‰æ‰€å¢å¼ºï¼Œä½ å¯ä»¥ç›´æ¥è°ƒç”¨`Collections.stream()`æˆ–è€…`Collection.parallelStream()`æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªæµå¯¹è±¡ã€‚ç­‰ä¼šä¼šè§£é‡Šè¿™ä¸ªæœ€å¸¸ç”¨çš„æ“ä½œã€‚

#### Filter
`Filter`æ¥å—ä¸€ä¸ª`predicate`æ¥å£ç±»å‹çš„å˜é‡ï¼Œå¹¶å°†æ‰€æœ‰æµå¯¹è±¡ä¸­çš„å…ƒç´ è¿›è¡Œè¿‡æ»¤ã€‚è¯¥æ“ä½œæ˜¯ä¸€ä¸ªä¸­é—´æ“ä½œï¼Œå› æ­¤å®ƒå…è®¸æˆ‘ä»¬åœ¨è¿”å›ç»“æœçš„åŸºç¡€ä¸Šå†è¿›è¡Œå…¶ä»–çš„æµæ“ä½œ(forEach)ã€‚`ForEach`æ¥å—ä¸€ä¸ª`function`æ¥å£ç±»å‹çš„å˜é‡ï¼Œç”¨æ¥æ‰§è¡Œå¯¹æ¯ä¸€ä¸ªå…ƒç´ çš„æ“ä½œã€‚`ForEach`æ˜¯ä¸€ä¸ªç»ˆæ­¢æ“ä½œã€‚å®ƒä¸è¿”å›æµï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½å†è°ƒç”¨å…¶ä»–çš„æµæ“ä½œã€‚

```java
stringCollection
.stream()
.filter((s) -> s.startsWith("a"))
.forEach(System.out::println);

// "aaa2","aaa1"
```

#### Sorted
`Sorted` æ˜¯ä¸€ä¸ªä¸­é—´æ“ä½œï¼Œèƒ½å¤Ÿè¿”å›ä¸€ä¸ªæ’è¿‡åºçš„æµå¯¹è±¡çš„è§†å›¾ã€‚æµå¯¹è±¡ä¸­çš„å…ƒç´ ä¼šé»˜è®¤æŒ‰ç…§è‡ªç„¶é¡ºåºè¿›è¡Œæ’åºï¼Œé™¤éä½ ä¸­é—´æŒ‡å®šä¸€ä¸ª`Comparator`æ¥å£æ¥æ”¹å˜æ’åºè§„åˆ™ã€‚

```java
stringCollection
.stream()
.sorted()
.filter((s) -> s.startsWith("a"))
.forEach(System.out :: println);

// "aaa2","aaa1"
```

ä¸€å®šè¦è®°ä½ï¼Œ`sorted`åªæ˜¯åˆ›å»ºä¸€ä¸ªæµå¯¹è±¡æ’åºçš„è§†å›¾ï¼Œè€Œä¸ä¼šæ”¹å˜åŸæ¥é›†åˆä¸­å…ƒç´ çš„é¡ºåºã€‚åŸæ¥stringé›†åˆä¸­çš„å…ƒç´ é¡ºåºæ˜¯æ²¡æœ‰æ”¹å˜çš„ã€‚

```java
System.out.println(stringCollection);
// ddd2, aaa2, bbb1, aaa1, bbb3, ccc, bbb2, ddd1
```

#### Map
map æ˜¯ä¸€ä¸ªå¯¹äºæµå¯¹è±¡çš„ä¸­é—´æ“ä½œï¼Œé€šè¿‡ç»™å®šçš„æ–¹æ³•ï¼Œå®ƒèƒ½å¤ŸæŠŠæµå¯¹è±¡ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ å¯¹åº”åˆ°å¦å¤–ä¸€ä¸ªå¯¹è±¡ä¸Šã€‚ä¸‹é¢çš„ä¾‹å­å°±æ¼”ç¤ºäº†å¦‚ä½•æŠŠæ¯ä¸ª`String`éƒ½è½¬æ¢æˆå¤§å†™çš„`String`.ä¸ä½†å¦‚æ­¤ï¼Œä½ è¿˜å¯ä»¥æŠŠæ¯ä¸€ç§å¯¹è±¡æ˜ å°„æˆä¸ºå…¶ä»–ç±»å‹ã€‚å¯¹äºå¸¦æ³›å‹ç»“æœçš„æµå¯¹è±¡ï¼Œå…·ä½“çš„ç±»å‹è¿˜è¦ç”±ä¼ é€’ç»™mapçš„æ³›å‹æ–¹æ³•æ¥å†³å®šã€‚

```java
stringCollection
.stream()
.map(String :: toUpperCase)
.sorted((a,b) -> b.compareTo(a))
.forEach(System.out::println);

// "DDD2", "DDD1", "CCC", "BBB3", "BBB2", "AAA2", "AAA1"
```

#### Match
åŒ¹é…æ“ä½œæœ‰å¤šé‡ä¸åŒçš„ç±»å‹ï¼Œéƒ½æ˜¯ç”¨æ¥åˆ¤æ–­æŸä¸€ç§è§„åˆ™æ˜¯å¦ä¸æµå¯¹è±¡ç›¸äº’å»åˆçš„æ‰€æœ‰çš„ä½©ä½©æ“ä½œéƒ½æ˜¯ç»ˆç»“æ“ä½œï¼Œåªè¿”å›ä¸€ä¸ª`boolean`ç±»å‹çš„ç»“æœã€‚

```java
boolean anyStartsWithA =
   stringCollection
.stream()
.anyMatch((s) -> s.startsWith("a"));

System.out.println(anyStartsWithA); // true

boolean allStartsWithA = stringCollection
.stream()
.allMatch((s) -> s.startsWith("a"));

System.out.println(allStartsWithA); // false

boolean noneStartsWithZ = stringCollection
.stream()
.noneMatch((s) -> s.startsWith("z"));

System.out.println(noneStartsWithZ); // true
```

#### Count
Countæ˜¯ä¸€ä¸ªç»ˆç»“æ“ä½œï¼Œå®ƒçš„ä½œç”¨æ˜¯è¿”å›ä¸€ä¸ªæ•°å€¼ï¼Œç”¨æ¥æ ‡è¯†å½“å‰æµå¯¹è±¡ä¸­åŒ…å«çš„å…ƒç´ æ•°é‡ã€‚

```java
long startsWithB =
   stringCollection
.stream()
.filter((s) -> s.startsWith("b"))
.count();

System.out.println(startsWithB); // 3
```

#### Reduce
è¯¥æ“ä½œæ˜¯ä¸€ä¸ªç»ˆç»“æ“ä½œï¼Œå®ƒèƒ½å¤Ÿé€šè¿‡æŸä¸€ä¸ªæ–¹æ³•ï¼Œå¯¹å…ƒç´ è¿›è¡Œå‰Šå‡æ“ä½œã€‚è¯¥æ“ä½œçš„ç»“æœä¼šæ”¾åœ¨ä¸€ä¸ªOptionalå˜é‡é‡Œè¿”å›ã€‚

```java
Optional<String> reduced =
   stringCollection
.stream()
.sorted()
.reduce((s1, s2) -> s1 + "#" + s2);

reduced.ifPresent(System.out::println);
// "aaa1#aaa2#bbb1#bbb2#bbb3#ccc#ddd1#ddd2"

```

#### Parallel Streams
åƒä¸Šé¢æ‰€è¯´çš„ï¼Œæµæ“ä½œå¯ä»¥æ˜¯é¡ºåºçš„ï¼Œä¹Ÿå¯ä»¥æ˜¯å¹¶è¡Œçš„ã€‚é¡ºåºæ“ä½œé€šè¿‡å•çº¿ç¨‹æ‰§è¡Œï¼Œè€Œå¹¶è¡Œæ“ä½œåˆ™é€šè¿‡å¤šçº¿ç¨‹æ‰§è¡Œã€‚


ä¸‹é¢çš„ä¾‹å­å°±æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨å¹¶è¡Œæµè¿›è¡Œæ“ä½œæ¥æé«˜è¿è¡Œæ•ˆç‡ï¼Œä»£ç éå¸¸ç®€å•ã€‚


é¦–å…ˆæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¤§çš„ listï¼Œé‡Œé¢çš„å…ƒç´ éƒ½æ˜¯å”¯ä¸€çš„ï¼š
```java
int max = 1000000;
List<String> values = new ArrayList<>(max);
for(int i= 0; i< max; i++){
    UUID uuid = UUID.randomUUID();
    values.add(uuid.toString());
}
```
ç°åœ¨æˆ‘ä»¬æµ‹é‡ä¸€ä¸‹å¯¹è¿™ä¸ªé›†åˆè¿›è¡Œæ’åºæ‰€ä½¿ç”¨çš„æ—¶é—´ã€‚

#### é¡ºåºæ’åº
```java
long t0 = System.nanoTime();

long count = values.stream().sorted().count();
System.out.println(count);

long t1 = System.nanoTime();

long millis = TimeUnit.NANOSECONDS.toMillis(t1 - t0);
System.out.println(String.format("sequential sort took: %d ms", millis));

// sequential sort took: 899 ms
```

#### å¹¶è¡Œæ’åº
```java
long t0 = System.nanoTime();

long count = values.parallelStream().sorted().count();
System.out.println(count);

long t1 = System.nanoTime();

long millis = TimeUnit.NANOSECONDS.toMillis(t1 - t0);
System.out.println(String.format("parallel sort took: %d ms", millis));

// parallel sort took: 472 ms
```
å¦‚ä½ æ‰€è§ï¼Œæ‰€æœ‰çš„ä»£ç æ®µå‡ ä¹éƒ½ç›¸åŒï¼Œå”¯ä¸€çš„ä¸åŒå°±æ˜¯æŠŠ`stream()`æ”¹æˆäº†`parallelStream()`, ç»“æœå¹¶è¡Œæ’åºå¿«äº†50%ã€‚

#### Map
æ­£å¦‚å‰é¢å·²ç»æåˆ°çš„é‚£æ ·ï¼Œmap æ˜¯ä¸æ”¯æŒæµæ“ä½œçš„è€Œæ›´æ–°åçš„map ç°åœ¨åˆ™æ”¯æŒå¤šç§å®ç”¨çš„æ–°æ–¹æ³•ï¼Œæ¥å®Œæˆå¸¸è§„çš„ä»»åŠ¡ã€‚

```java
Map<Integer, String> map = new HashMap<>();
for(int i = 0; i< 10; i++){
    map.putIfAbsent(i,"val"+i);
}
map.forEach((id,val) -> System.out.println(val));
```
ä¸Šé¢çš„ä»£ç é£æ ¼æ˜¯å®Œå…¨è‡ªè§£é‡Šçš„ï¼š`putIfAbsent`é¿å…æˆ‘ä»¬å°†`null`å†™å…¥ï¼›`forEach`æ¥å—ä¸€ä¸ªæ¶ˆè´¹è€…å¯¹è±¡ï¼Œä»è€Œå°†æ“ä½œå®æ–½åˆ°æ¯ä¸€ä¸ª`map`ä¸­çš„å€¼ä¸Šã€‚


ä¸‹çš„è¿™ä¸ªä¾‹å­å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨å‡½æ•°æ¥è®¡ç®—`map`çš„ç¼–ç ï¼š
```java
map.computeIfPresent(3, (num, val) -> val + num);
map.get(3); // val33

map.computeIfPresent(9, (num, val) -> null);
map.containsKey(9); // false

map.computeIfAbsent(23, num -> "val" + num);
map.containsKey(23); // true

map.computeIfAbsent(3, num -> "bam");
map.get(3); // val33
```

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å­¦ä¹ ï¼Œå½“ç»™å®šä¸€ä¸ªkeyå€¼æ—¶ï¼Œå¦‚ä½•æŠŠä¸€ä¸ªå®ä¾‹ä»å¯¹åº”çš„keyä¸­ç§»é™¤ï¼š

```java
map.remove(3, "val3"); 
map.get(3); // val33

map.remove(3, "val33");
map.get(3); // null
```

å¦ä¸€ä¸ªæœ‰ç”¨çš„æ–¹æ³•ï¼š
```java
map.getOrDefault(42, "not found"); // not found
```

å°†mapä¸­çš„å®ä¾‹åˆå¹¶ä¹Ÿæ˜¯éå¸¸å®¹æ˜“çš„ï¼š
```java
map.merge(9,"val9",(value, newValue) -> value.concat(newValue));
map.get(9); // val9

map.merge(9,"concat",(value, newValue) -> value.concat(newValue));
map.get(9); // val9concat
```
åˆå¹¶æ“ä½œå…ˆçœ‹`map`ä¸­æ˜¯å¦æ²¡æœ‰ç‰¹å®šçš„key/valueå­˜åœ¨ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™æŠŠ`key/value`å­˜å…¥mapï¼Œå¦åˆ™`merging`å‡½æ•°å°±ä¼šè¢«è°ƒç”¨ï¼Œå¯¹ç°æœ‰çš„æ•°å€¼è¿›è¡Œä¿®æ”¹ã€‚

### æ—¶é—´æ—¥æœŸAPI
Java 8åŒ…å«äº†å…¨æ–°çš„æ—¶é—´æ—¥æœŸAPIï¼Œè¿™äº›åŠŸèƒ½éƒ½æ”¾åœ¨äº†java.time åŒ…ä¸‹ã€‚æ–°çš„æ—¶é—´æ—¥æœŸAPIæ˜¯åŸºäº`joda-Time`åº“å¼€å‘çš„ï¼Œä½†æ˜¯ä¹Ÿä¸å°½ç›¸åŒã€‚ä¸‹é¢çš„ä¾‹å­å°±æ¶µç›–äº†å¤§å¤šæ•°æ–°çš„APIçš„é‡è¦éƒ¨åˆ†ã€‚

#### Clock
Clock æä¾›äº†å¯¹å½“å‰æ—¶é—´å’Œæ—¥æœŸçš„è®¿é—®åŠŸèƒ½ã€‚`Clock`æ˜¯å¯¹å½“å‰æ—¶åŒºæ•æ„Ÿçš„ï¼Œå¹¶å¯ç”¨äºæ›¿ä»£`System.currentTimeMillis()`æ–¹æ³•æ¥è·å–å½“å‰çš„æ¯«ç§’æ—¶é—´ã€‚å½“å‰æ—¶é—´çº¿ä¸Šçš„æ—¶åˆ»å¯ä»¥ç”¨`Instance`ç±»æ¥è¡¨ç¤ºã€‚`Instance`ä¹Ÿèƒ½å¤Ÿç”¨äºåˆ›å»ºåŸå…ˆçš„`java.util.Date`å¯¹è±¡ã€‚

```java
Clock clock = Clock.systemDefaultZone();
long millis = clock.millis();

Instant instant = clock.instant();
Date legacyDate = Date.from(instant); // legacy java.util.Date
```

#### Timezones
æ—¶åŒºç±»å¯ä»¥ç”¨ä¸€ä¸ª `Zoneld`æ¥è¡¨ç¤ºã€‚ æ—¶åŒºç±»çš„å¯¹è±¡å¯ä»¥é€šè¿‡é™æ€å·¥å‚æ–¹æ³•æ–¹ä¾¿åœ°è·å–ã€‚æ—¶åŒºç±»è¿˜å®šä¹‰äº†ä¸€ä¸ªåç§»é‡ï¼Œç”¨æ¥åœ¨å½“å‰æ—¶åˆ»æˆ–æŸæ—¶é—´ä¸ç›®æ ‡æ—¶åŒºæ—¶é—´ä¹‹é—´è¿›è¡Œè½¬æ¢ã€‚

```java
System.out.println(ZoneId.getAvailableZoneIds());
// prints all available timezone ids

ZoneId zone1 = ZoneId.of("Europe/Berlin");
ZoneId zone2 = ZoneId.of("Brazil/East");
System.out.println(zone1.getRules());
System.out.println(zone2.getRules());

// ZoneRules[currentStandardOffset=+01:00]
// ZoneRules[currentStandardOffset=-03:00]
```

#### LocalTime
æœ¬åœ°æ—¶é—´ç±»è¡¨ç¤ºä¸€ä¸ªæ²¡æœ‰æŒ‡å®šæ—¶åŒºçš„æ—¶é—´ï¼Œä¾‹å¦‚ï¼Œ10 p.m.æˆ–è€…17:30:15ï¼Œä¸‹é¢çš„ä¾‹å­ä¼šç”¨ä¸Šé¢çš„ä¾‹å­å®šä¹‰çš„æ—¶åŒºåˆ›å»ºä¸¤ä¸ªæœ¬åœ°æ—¶é—´å¯¹è±¡ã€‚ç„¶åæˆ‘ä»¬ä¼šæ¯”è¾ƒä¸¤ä¸ªæ—¶é—´ï¼Œå¹¶è®¡ç®—å®ƒä»¬ä¹‹é—´çš„å°æ—¶å’Œåˆ†é’Ÿçš„ä¸åŒã€‚

```java
LocalTime now1 = LocalTime.now(zone1);
LocalTime now2 = LocalTime.now(zone2);

System.out.println(now1.isBefore(now2)); // false

long hoursBetween = ChronoUnit.HOURS.between(now1, now2);
long minutesBetween = ChronoUnit.MINUTES.between(now1, now2);

System.out.println(hoursBetween); // -3
System.out.println(minutesBetween); // -239
```

LocalTimeæ˜¯ç”±å¤šä¸ªå·¥å‚æ–¹æ³•ç»„æˆï¼Œå…¶ç›®çš„æ˜¯ä¸ºäº†ç®€åŒ–å¯¹æ—¶é—´å¯¹è±¡å®ä¾‹çš„åˆ›å»ºå’Œæ“ä½œï¼ŒåŒ…æ‹¬å¯¹æ—¶é—´å­—ç¬¦ä¸²è¿›è¡Œè§£æçš„æ“ä½œã€‚

```java
LocalTime late = LocalTime.of(23, 59, 59);
System.out.println(late); // 23:59:59

DateTimeFormatter germanFormatter =
DateTimeFormatter
.ofLocalizedTime(FormatStyle.SHORT)
.withLocale(Locale.GERMAN);

LocalTime leetTime = LocalTime.parse("13:37", germanFormatter);
System.out.println(leetTime); // 13:37
```

#### LocalDate
æœ¬åœ°æ—¶é—´è¡¨ç¤ºäº†ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„æ—¶é—´ï¼Œä¾‹å¦‚ï¼š2014-03-11ã€‚è¿™ä¸ªæ—¶é—´æ˜¯ä¸å¯å˜çš„ï¼Œä¸LocalTimeæ˜¯åŒæºçš„ã€‚ä¸‹é¢çš„ä¾‹å­æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡åŠ å‡æ—¥ï¼Œæœˆï¼Œå¹´ç­‰æŒ‡æ ‡æ¥è®¡ç®—æ–°çš„æ—¥æœŸã€‚è®°ä½ï¼Œæ¯ä¸€æ¬¡æ“ä½œéƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°çš„æ—¶é—´å¯¹è±¡ã€‚

```java
LocalDate today = LocalDate.now();
LocalDate tomorrow = today.plus(1, ChronoUnit.DAYS);
LocalDate yesterday = tomorrow.minusDays(2);

LocalDate independenceDay = LocalDate.of(2014, Month.JULY, 4);
DayOfWeek dayOfWeek = independenceDay.getDayOfWeek();
System.out.println(dayOfWeek); // FRIDAY 
```

è§£æå­—ç¬¦ä¸²å¹¶å½¢æˆ`LocalDate`å¯¹è±¡ï¼Œè¿™ä¸ªæ“ä½œå’Œè§£æ`LocalTime`ä¸€æ ·ç®€å•ã€‚

```java
DateTimeFormatter germanFormatter =
DateTimeFormatter
.ofLocalizedDate(FormatStyle.MEDIUM)
.withLocale(Locale.GERMAN);

LocalDate xmas = LocalDate.parse("24.12.2014", germanFormatter);
System.out.println(xmas); // 2014-12-24
```

#### LocalDateTime
LocalDateTimeè¡¨ç¤ºçš„æ˜¯æ—¥æœŸ-æ—¶é—´ã€‚å®ƒå°†åˆšæ‰ä»‹ç»çš„æ—¥æœŸå¯¹è±¡å’Œæ—¶é—´å¯¹è±¡ç»“åˆèµ·æ¥ï¼Œå½¢æˆäº†ä¸€ä¸ªå¯¹è±¡å®ä¾‹ã€‚`LocalDateTime`æ˜¯ä¸å¯å˜çš„ï¼Œä¸`LocalTime`å’Œ`LocalDate`çš„å·¥ä½œåŸç†ç›¸åŒã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨æ–¹æ³•æ¥è·å–æ—¥æœŸæ—¶é—´å¯¹è±¡ä¸­ç‰¹å®šçš„æ•°æ®åŸŸã€‚

```java
LocalDateTime sylvester = LocalDateTime.of(2014, Month.DECEMBER, 31, 23, 59, 59);

DayOfWeek dayOfWeek = sylvester.getDayOfWeek();
System.out.println(dayOfWeek); // WEDNESDAY

Month month = sylvester.getMonth();
System.out.println(month); // DECEMBER

long minuteOfDay = sylvester.getLong(ChronoField.MINUTE_OF_DAY);
System.out.println(minuteOfDay); // 1439
```
å¦‚æœå†åŠ ä¸Šçš„æ—¶åŒºä¿¡æ¯ï¼Œ`LocalDateTime`èƒ½å¤Ÿè¢«è½¬æ¢æˆ`Instance`å®ä¾‹ã€‚`Instance`èƒ½å¤Ÿè¢«è½¬æ¢æˆä»¥å‰çš„`java.util.Date`å¯¹è±¡ã€‚

```java
Instant instant = sylvester
.atZone(ZoneId.systemDefault())
.toInstant();

Date legacyDate = Date.from(instant);
System.out.println(legacyDate); // Wed Dec 31 23:59:59 CET 2014
```

æ ¼å¼åŒ–æ—¥æœŸ-æ—¶é—´å¯¹è±¡å°±å’Œæ ¼å¼åŒ–æ—¥æœŸå¯¹è±¡æˆ–è€…æ—¶é—´å¯¹è±¡ä¸€æ ·ã€‚é™¤äº†ä½¿ç”¨é¢„å®šä¹‰çš„æ ¼å¼ä»¥å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åˆ›å»ºè‡ªå®šä¹‰çš„æ ¼å¼åŒ–å¯¹è±¡ï¼Œç„¶ååŒ¹é…æˆ‘ä»¬è‡ªå®šä¹‰çš„æ ¼å¼ã€‚

```java
DateTimeFormatter formatter =
DateTimeFormatter
.ofPattern("MMM dd, yyyy - HH:mm");

LocalDateTime parsed = LocalDateTime.parse("Nov 03, 2014 - 07:13", formatter);
String string = formatter.format(parsed);
System.out.println(string); // Nov 03, 2014 - 07:13
```

ä¸åŒäº` java.text.NumberFormat`ï¼Œæ–°çš„`DateTimeFormatter`ç±»æ˜¯ä¸å¯å˜çš„ï¼Œä¹Ÿæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚

### Annotations
Java 8ä¸­çš„æ³¨è§£æ˜¯å¯é‡å¤çš„ã€‚è®©æˆ‘ä»¬ç›´æ¥æ·±å…¥çœ‹çœ‹ä¾‹å­ï¼Œå¼„æ˜ç™½å®ƒæ˜¯ä»€ä¹ˆæ„æ€ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªåŒ…è£…æ³¨è§£ï¼Œå®ƒåŒ…æ‹¬äº†ä¸€ä¸ªå®é™…æ³¨è§£çš„æ•°ç»„
```java
@interface Hints { 
    Hint[] value();
}

@Repeatable(Hints.class)
    @interface Hint {
    String value();
}
```

åªè¦åœ¨å‰é¢åŠ ä¸Šæ³¨è§£åï¼š`@Repeatable`ï¼ŒJava 8 å…è®¸æˆ‘ä»¬å¯¹åŒä¸€ç±»å‹ä½¿ç”¨å¤šé‡æ³¨è§£ï¼Œ

å˜ä½“1ï¼šä½¿ç”¨æ³¨è§£å®¹å™¨ï¼ˆè€æ–¹æ³•ï¼‰
```java
@Hints({@Hint("hint1"), @Hint("hint2")})
class Person {}
å˜ä½“2ï¼šä½¿ç”¨å¯é‡å¤æ³¨è§£ï¼ˆæ–°æ–¹æ³•ï¼‰

@Hint("hint1")
@Hint("hint2")
class Person {}
```

ä½¿ç”¨å˜ä½“2ï¼ŒJavaç¼–è¯‘å™¨èƒ½å¤Ÿåœ¨å†…éƒ¨è‡ªåŠ¨å¯¹`@Hint`è¿›è¡Œè®¾ç½®ã€‚è¿™å¯¹äºé€šè¿‡åå°„æ¥è¯»å–æ³¨è§£ä¿¡æ¯æ¥è¯´ï¼Œæ˜¯éå¸¸é‡è¦çš„ã€‚
```java
Hint hint = Person.class.getAnnotation(Hint.class);
System.out.println(hint); // null

Hints hints1 = Person.class.getAnnotation(Hints.class);
System.out.println(hints1.value().length); // 2

Hint[] hints2 = Person.class.getAnnotationsByType(Hint.class);
System.out.println(hints2.length); // 2
```

å°½ç®¡æˆ‘ä»¬ç»å¯¹ä¸ä¼šåœ¨Personç±»ä¸Šå£°@Hintsæ³¨è§£ï¼Œä½†æ˜¯å®ƒçš„ä¿¡æ¯ä»ç„¶å¯ä»¥é€šè¿‡`getAnnotation(Hints.class)`æ¥è¯»å–ã€‚å¹¶ä¸”ï¼Œ`getAnnotationsByType`æ–¹æ³•ä¼šæ›´æ–¹ä¾¿ï¼Œå› ä¸ºå®ƒèµ‹äºˆäº†æ‰€æœ‰`@Hintsæ³¨è§£`çš„æ–¹æ³•ç›´æ¥çš„è®¿é—®æƒé™ã€‚
```java
@Target({ElementType.TYPE_PARAMETER, ElementType.TYPE_USE})
@interface MyAnnotation {}
```



> æœ¬æ–‡ç”± [ImportNew](http://www.importnew.com/) - [é»„å°é](http://www.importnew.com/author/huangxiaofei) ImportNew.com - [é»„å°é](http://www.importnew.com/author/huangxiaofei) ç¿»è¯‘è‡ª [winterbe](http://winterbe.com/posts/2014/03/16/java-8-tutorial/)ã€‚


![](https://ws3.sinaimg.cn/large/006tKfTcgy1fqj5aochgoj309k09kmwz.jpg)
<b><center>æ‰«æå…³æ³¨ï¼šçƒ­çˆ±ç”Ÿæ´»çš„å¤§å”</center>
<b><center><font size="2">ï¼ˆ<font size="2" color="#FF0000">è½¬è½½æœ¬ç«™æ–‡ç« è¯·æ³¨æ˜ä½œè€…å’Œå‡ºå¤„</font> <font size="2" color="#0000FF">çƒ­çˆ±ç”Ÿæ´»çš„å¤§å”-uniquezhangqi</font><font size="2">ï¼‰</font>

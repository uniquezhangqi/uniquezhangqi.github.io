I"€"<h4 id="springcontextholderé™æ€æŒæœ‰springcontextçš„å¼•ç”¨">SpringContextHolderé™æ€æŒæœ‰SpringContextçš„å¼•ç”¨</h4>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SpringContextHolder</span> <span class="kd">implements</span> <span class="nc">ApplicationContextAware</span><span class="o">{</span>
 
    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">ApplicationContext</span> <span class="n">applicationContext</span><span class="o">;</span>
 
     
    <span class="c1">//å®ç°ApplicationContextAwareæ¥å£çš„contextæ³¨å…¥å‡½æ•°, å°†å…¶å­˜å…¥é™æ€å˜é‡.</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setApplicationContext</span><span class="o">(</span><span class="nc">ApplicationContext</span> <span class="n">applicationContext</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">SpringContextHolder</span><span class="o">.</span><span class="na">applicationContext</span> <span class="o">=</span> <span class="n">applicationContext</span><span class="o">;</span>
    <span class="o">}</span>
 
    
    <span class="c1">//å–å¾—å­˜å‚¨åœ¨é™æ€å˜é‡ä¸­çš„ApplicationContext.</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">ApplicationContext</span> <span class="nf">getApplicationContext</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">checkApplicationContext</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">applicationContext</span><span class="o">;</span>
    <span class="o">}</span>
     
    <span class="c1">//ä»é™æ€å˜é‡ApplicationContextä¸­å–å¾—Bean, è‡ªåŠ¨è½¬å‹ä¸ºæ‰€èµ‹å€¼å¯¹è±¡çš„ç±»å‹.</span>
    <span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="s">"unchecked"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="no">T</span> <span class="nf">getBean</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">checkApplicationContext</span><span class="o">();</span>
        <span class="k">return</span> <span class="o">(</span><span class="no">T</span><span class="o">)</span> <span class="n">applicationContext</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>
    <span class="o">}</span>
 
     
    <span class="c1">//ä»é™æ€å˜é‡ApplicationContextä¸­å–å¾—Bean, è‡ªåŠ¨è½¬å‹ä¸ºæ‰€èµ‹å€¼å¯¹è±¡çš„ç±»å‹.</span>
    <span class="c1">//å¦‚æœæœ‰å¤šä¸ªBeanç¬¦åˆClass, å–å‡ºç¬¬ä¸€ä¸ª.</span>
    <span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="s">"unchecked"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="no">T</span> <span class="nf">getBean</span><span class="o">(</span><span class="nc">Class</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="n">clazz</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">checkApplicationContext</span><span class="o">();</span>
        <span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="s">"rawtypes"</span><span class="o">)</span>
                <span class="nc">Map</span> <span class="n">beanMaps</span> <span class="o">=</span> <span class="n">applicationContext</span><span class="o">.</span><span class="na">getBeansOfType</span><span class="o">(</span><span class="n">clazz</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">beanMaps</span><span class="o">!=</span><span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">beanMaps</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">return</span> <span class="o">(</span><span class="no">T</span><span class="o">)</span> <span class="n">beanMaps</span><span class="o">.</span><span class="na">values</span><span class="o">().</span><span class="na">iterator</span><span class="o">().</span><span class="na">next</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">else</span><span class="o">{</span>
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
 
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">checkApplicationContext</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">applicationContext</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalStateException</span><span class="o">(</span><span class="s">"applicaitonContextæœªæ³¨å…¥,è¯·åœ¨applicationContext.xmlä¸­å®šä¹‰SpringContextHolder"</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
 
<span class="o">}</span>
<span class="o">&lt;!--</span> <span class="n">ç”¨äºæŒæœ‰ApplicationContext</span><span class="o">,</span><span class="n">å¯ä»¥ä½¿ç”¨SpringContextHolder</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="err">'</span><span class="n">xxxx</span><span class="err">'</span><span class="o">)</span><span class="n">çš„é™æ€æ–¹æ³•å¾—åˆ°spring</span> <span class="n">beanå¯¹è±¡</span> <span class="o">--&gt;</span>  

<span class="o">&lt;</span><span class="n">bean</span> <span class="kd">class</span><span class="err">="</span><span class="nc">com</span><span class="o">.</span><span class="na">xxxxx</span><span class="o">.</span><span class="na">SpringContextHolder</span><span class="err">"</span>  <span class="o">/&gt;</span>

</code></pre></div></div>

<p>è¯¥å·¥å…·ç±»ä¸»è¦ç”¨äºï¼šé‚£äº›æ²¡æœ‰å½’å…¥springæ¡†æ¶ç®¡ç†çš„ç±»å´è¦è°ƒç”¨springå®¹å™¨ä¸­çš„beanæä¾›çš„å·¥å…·ç±»ã€‚</p>

<p>åœ¨springä¸­è¦é€šè¿‡IOCä¾èµ–æ³¨å…¥æ¥å–å¾—å¯¹åº”çš„å¯¹è±¡ï¼Œä½†æ˜¯è¯¥ç±»é€šè¿‡å®ç°ApplicationContextAwareæ¥å£ï¼Œä»¥é™æ€å˜é‡ä¿å­˜Spring ApplicationContext, å¯åœ¨ä»»ä½•ä»£ç ä»»ä½•åœ°æ–¹ä»»ä½•æ—¶å€™ä¸­å–å‡ºApplicaitonContext.</p>

<p>å¦‚æ­¤å°±ä¸èƒ½è¯´è¯´org.springframework.context.ApplicationContextAwareè¿™ä¸ªæ¥å£äº†ï¼š</p>

<p>å½“ä¸€ä¸ªç±»å®ç°äº†è¿™ä¸ªæ¥å£ï¼ˆApplicationContextAwareï¼‰ä¹‹åï¼Œè¿™ä¸ªç±»å°±å¯ä»¥æ–¹ä¾¿è·å¾—ApplicationContextä¸­çš„æ‰€æœ‰beanã€‚æ¢å¥è¯è¯´ï¼Œå°±æ˜¯è¿™ä¸ªç±»å¯ä»¥ç›´æ¥è·å–springé…ç½®æ–‡ä»¶ä¸­ï¼Œæ‰€æœ‰æœ‰å¼•ç”¨åˆ°çš„beanå¯¹è±¡ã€‚</p>

<p>é™¤äº†ä»¥ä¸ŠSpringContextHolderç±»ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸éœ€è¦å¤šæ¬¡åŠ è½½springé…ç½®æ–‡ä»¶å°±å¯ä»¥å–å¾—beançš„ç±»ï¼š</p>

<p>1.Struts2æ¡†æ¶ä¸­ï¼Œåœ¨ç›‘å¬å™¨ä¸­æœ‰è¿™ä¹ˆä¸€å¥
ApplicationContext context = WebApplicationContextUtils.getWebApplicationContext(event.getServletContext());
ä¹‹åå¯ä»¥ç”¨
scheduleService = (IScheduleService)context.getBean(â€œscheduleServiceâ€);
å–åˆ°å¯¹è±¡ï¼Œè¯·é—®contextéƒ½å¯ä»¥å–åˆ°ä»€ä¹ˆä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯çš„æ¥æºåœ¨å“ªï¼Ÿæ˜¯XMLé‡Œé…ç½®äº†å‘¢ï¼Œè¿˜æ˜¯å›ºå®šçš„ä¸€éƒ¨åˆ†ä¿¡æ¯å‘¢ï¼Ÿ
2ã€è¿™ä¸ª applicationå°è£…çš„æ˜¯web.xml å†…éƒ¨çš„ä¿¡æ¯
è€Œä½ çš„web.xmlé‡Œé¢æœ‰springçš„é…ç½®æ–‡ä»¶ï¼Œæ‰€æœ‰ï¼Œé‡Œé¢è¿˜åŒ…å«springçš„ä¿¡æ¯
åŒæ ·åŒ…å«struts2çš„filterä¿¡æ¯
æ€»ä¹‹å°±æ˜¯å’Œweb.xmlæœ‰å…³ç³»çš„æ‰€æœ‰ä¿¡æ¯</p>

<p>3ã€åœ¨web.xmlé‡Œæœ‰è¿™ä¹ˆä¸€æ®µ
    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/applicationContext*.xml</param-value>
    </context-param></p>

<p>é‚£ä¹ˆåœ¨å–ä¿¡æ¯çš„æ—¶å€™ï¼Œä¹Ÿä¼šæŠŠapplicationContext.xmlé‡Œçš„ä¿¡æ¯å–å‡ºæ¥
1
<br /><br /><br /><br /><br /></p>

<blockquote>
  <p>è½¬è½½æ±Ÿå—çƒŸé›¨ï¼š<a href="https://www.cnblogs.com/wcyBlog/p/4657885.html">https://www.cnblogs.com/wcyBlog/p/4657885.html</a></p>
</blockquote>

<p><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1fqj5aochgoj309k09kmwz.jpg" alt="" />
<b><center>æ‰«æå…³æ³¨ï¼šçƒ­çˆ±ç”Ÿæ´»çš„å¤§å”</center>
<b><center><font size="2">ï¼ˆ<font size="2" color="#FF0000">è½¬è½½æœ¬ç«™æ–‡ç« è¯·æ³¨æ˜ä½œè€…å’Œå‡ºå¤„</font> <font size="2" color="#0000FF">çƒ­çˆ±ç”Ÿæ´»çš„å¤§å”-uniquezhangqi</font><font size="2">ï¼‰</font></font></center></b></b></p>
:ET